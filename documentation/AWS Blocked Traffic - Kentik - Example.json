{
  "iapVersions": [
    "2023.1"
  ],
  "adapters": [
    {
      "isDependency": true,
      "name": "adapter-aws_ec2",
      "overview": "Adapter that connects to AWS.",
      "webName": "Amazon EC2",
      "repoLink": "https://gitlab.com/itentialopensource/adapters/cloud/adapter-aws_ec2",
      "version": "^0.6.9",
      "docLink": "https://docs.itential.com/opensource/docs/amazon-aws-ec2",
      "webLink": "https://www.itential.com/adapters/amazon-ec2/"
    },
    {
      "isDependency": true,
      "name": "adapter-service_now",
      "overview": "Adapter that connects to ServiceNow",
      "webName": "ServiceNow",
      "repoLink": "https://gitlab.com/itentialopensource/adapters/itsm-testing/adapter-servicenow",
      "version": "^2.6.3",
      "docLink": "https://docs.itential.com/opensource/docs/en/servicenow",
      "webLink": "https://www.itential.com/adapters/servicenow/"
    },
    {
      "isDependency": true,
      "name": "adapter-ms_teams",
      "overview": "Adapter that connects to Microsoft Teams",
      "webName": "Microsoft Teams",
      "repoLink": "https://gitlab.com/itentialopensource/adapters/notification-messaging/adapter-msteams",
      "version": "^0.13.0",
      "docLink": "https://docs.itential.com/opensource/docs/microsoft-teams",
      "webLink": "https://www.itential.com/adapters/microsoft-teams/"
    },
    {
      "isDependency": true,
      "name": "adapter-kentik_v5",
      "overview": "Adapter that connects to Kentik",
      "webName": "",
      "repoLink": "https://gitlab.com/itentialopensource/adapters/telemetry-analytics/adapter-kentik_v5",
      "version": "^0.1.1",
      "docLink": "",
      "webLink": ""
    },
    {
      "isDependency": true,
      "name": "adapter-automation_gateway",
      "overview": "Adapter that connects to Itential Automation Gateway",
      "webName": "Itential Automation Gateway",
      "version": "^4.29.0-2023.1.12",
      "docLink": "",
      "webLink": "https://www.itential.com/automation-gateway/"
    }
  ],
  "externalDependencyList": [
    {
      "name": "Kentik"
    },
    {
      "name": "AWS"
    },
    {
      "name": "MS Teams"
    },
    {
      "name": "ServiceNow"
    },
    {
      "name": "Itential Automation Gateway"
    }
  ],
  "capabilities": [
    {
      "capability": "Checks if source IP is in allowed IP list"
    },
    {
      "capability": "Sends MS Teams message indicating alarm triggered"
    },
    {
      "capability": "Adds source IP to AWS security group if source IP is in allowed IP list"
    },
    {
      "capability": "Sends MS Teams notification if unable to add source IP to AWS security group"
    },
    {
      "capability": "Creates ServiceNow Change Request if alarm triggered"
    }
  ],
  "entryPoint": {
    "name": "AWS Blocked Traffic - Kentik - Example",
    "type": "Operations Manager Automation"
  },
  "inputs": [
    {
      "name": "serviceNowAdapter",
      "type": "string",
      "required": "yes",
      "description": "ServiceNow adapter to use for this job",
      "exampleValue": "servicenow"
    },
    {
      "name": "msTeamsAdapter",
      "type": "string",
      "required": "yes",
      "description": "Microsoft Teams adapter to use for this job",
      "exampleValue": "msteams"
    },
    {
      "name": "awsEC2Adapter",
      "type": "string",
      "required": "yes",
      "description": "AWS EC2 adapter to use for this job",
      "exampleValue": "aws_ec2"
    },
    {
      "name": "iapUrl",
      "type": "string",
      "required": "yes",
      "description": "IAP URL to use in MS Teams and ServiceNow messages",
      "exampleValue": "https://iap_dev:443"
    },
    {
      "name": "serviceNowUrl",
      "type": "string",
      "required": "yes",
      "description": "ServiceNow URL to use in MS Teams messages",
      "exampleValue": "https://servicenow_dev.com"
    },
    {
      "name": "deviceOnboardingWebhookUrl",
      "type": "string",
      "required": "yes",
      "description": "Microsoft Teams Webhook URL for notification of device onboarding event.",
      "exampleValue": "webhookURL"
    },
    {
      "name": "allPolicyEventsWebhookUrl",
      "type": "string",
      "required": "yes",
      "description": "Microsoft Teams Webhook URL for notification of any policy event.",
      "exampleValue": "webhookURL"
    },
    {
      "name": "policyAutomatedAuthorizationWebhookUrl",
      "type": "string",
      "required": "yes",
      "description": "Microsoft Teams Webhook URL for notification of any policy authorization remediation event.",
      "exampleValue": "webhookURL"
    },
    {
      "name": "policyAutomatedFailureWebhookUrl",
      "type": "string",
      "required": "yes",
      "description": "Microsoft Teams Webhook URL for notification of any policy remediation failure event.",
      "exampleValue": "webhookURL"
    },
    {
      "name": "CompanyID",
      "type": "number",
      "required": "no",
      "description": "Company ID in Kentik",
      "exampleValue": "180173"
    },
    {
      "name": "CurrentState",
      "type": "string",
      "required": "no",
      "description": "Current state in Kentik",
      "exampleValue": "ackReq"
    },
    {
      "name": "Dimensions",
      "type": "object",
      "required": "yes",
      "description": "Kentik dimensions data",
      "exampleValue": "{}"
    },
    {
      "name": "Dimensions.AS_src",
      "type": "string",
      "required": "yes",
      "description": "AS source",
      "exampleValue": "198465"
    },
    {
      "name": "Dimensions.Geography_src",
      "type": "string",
      "required": "no",
      "description": "Geography source",
      "exampleValue": "US"
    },
    {
      "name": "Dimensions.IP_dst",
      "type": "string",
      "required": "yes",
      "description": "IP destination",
      "exampleValue": "10.0.18.252"
    },
    {
      "name": "Dimensions.IP_src",
      "type": "string",
      "required": "yes",
      "description": "IP source",
      "exampleValue": "45.129.14.30"
    },
    {
      "name": "Dimensions.kt_aws_action",
      "type": "string",
      "required": "no",
      "description": "Kentik AWS action",
      "exampleValue": "REJECT"
    },
    {
      "name": "Dimensions.kt_aws_dst_sg",
      "type": "string",
      "required": "yes",
      "description": "Kentik AWS destination security group",
      "exampleValue": "security-group"
    },
    {
      "name": "Dimensions.kt_aws_dst_vpc_id",
      "type": "string",
      "required": "yes",
      "description": "Kentik AWS destination VPC ID",
      "exampleValue": "vpc-0bf364141dd4f9120"
    },
    {
      "name": "Links",
      "type": "array",
      "required": "yes",
      "description": "Kentik links",
      "exampleValue": "[]"
    },
    {
      "name": "Links[i].Name",
      "type": "string",
      "required": "yes",
      "description": "Kentik link name",
      "exampleValue": "DashboardAlarmURL"
    },
    {
      "name": "Links[i].Label",
      "type": "string",
      "required": "no",
      "description": "Kentik link label",
      "exampleValue": "Open Dashboard"
    },
    {
      "name": "Links[i].Value",
      "type": "string",
      "required": "yes",
      "description": "Kentik link value",
      "exampleValue": "https://portal.kentik.com/v4/library/dashboards/18392"
    },
    {
      "name": "Description",
      "type": "string",
      "required": "no",
      "description": "Kentik alarm description",
      "exampleValue": "Alarm for Web Server Traffic Rejections Requires Ack"
    },
    {
      "name": "AlarmPolicyName",
      "type": "string",
      "required": "yes",
      "description": "The name of the alert policy generating this notification",
      "exampleValue": "US Policy Rejected Web Server Traffic"
    },
    {
      "name": "AlarmID",
      "type": "string",
      "required": "no",
      "description": "Alarm ID",
      "exampleValue": "266940386"
    },
    {
      "name": "AlarmPolicyMetadataType",
      "type": "string",
      "required": "no",
      "description": "Alarm policy metadata type",
      "exampleValue": "Custom"
    },
    {
      "name": "AlarmSeverity",
      "type": "string",
      "required": "no",
      "description": "Alarm severity",
      "exampleValue": "critical"
    },
    {
      "name": "AlarmThresholdID",
      "type": "string",
      "required": "no",
      "description": "Alarm threshold ID",
      "exampleValue": "446709"
    }
  ],
  "exampleInputsAndOutputs": [
    {
      "exampleInput": "{\n  \"iapUrl\": \"https://iap-dev:443\",\n  \"serviceNowUrl\": \"https://service-now.com\",\n  \"allPolicyEventsWebhookUrl\": \"webhookurl1\",\n  \"policyAutomatedFailureWebhookUrl\": \"webhookurl2\",\n  \"policyAutomatedAuthorizationWebhookUrl\": \"webhookurl3\",\n  \"serviceNowAdapter\": \"ServiceNow\",\n  \"awsEC2Adapter\": \"AWS\",\n  \"msTeamsAdapter\": \"MS Teams\",\n  \"AlarmPolicyName\": \"US Policy Rejected Web Server Traffic\",\n  \"Dimensions\": {\n    \"AS_src\": \"1000\",\n    \"IP_dst\": \"11.11.11.11\",\n    \"IP_src\": \"10.10.10.10\",\n    \"kt_aws_dst_sg\": \"aws_security_group\"\n  },\n  \"Links\": [\n    {\n      \"Name\": \"DashboardAlarmURL\",\n      \"Label\": \"Open Dashboard\",\n      \"Value\": \"https://portal.kentik.com/v4/library/dashboards/10000\"\n    },\n    {\n      \"Name\": \"DetailsAlarmURL\",\n      \"Label\": \"Open Details\",\n      \"Value\": \"https://portal.kentik.com/v4/alerting/a215729224\"\n    }\n  ]\n}"
    }
  ],
  "queryOutput": {},
  "name": "AWS Blocked Traffic - Kentik - Example",
  "overview": "Workflow that is started from Kentik that determines if IP address is whitelisted and if so adds it to security group in AWS. If the IP address is not whitelisted, a message is sent to MS Teams notifying of the alarm.",
  "webName": "Kentik AWS Blocked Traffic Alarm Example",
  "assetType": "Workflow"
}